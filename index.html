<head>
  <meta charset="ISO-8859-1">

  <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
  <!--script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script-->
  <script src="./vendor/aframe-ar.js"></script>
  <script src="./js/vendor/aframe-stl-model-component.min.js" type="text/javascript"></script>
  <script src="./vendor/STLLoader.js"></script>

  <!-- polyfill -->
	<script src="./MIDI/inc/shim/Base64.js" type="text/javascript"></script>
	<script src="./MIDI/inc/shim/Base64binary.js" type="text/javascript"></script>
	<script src="./MIDI/inc/shim/WebAudioAPI.js" type="text/javascript"></script>
	<!-- midi.js package -->
	<script src="./MIDI/js/midi/audioDetect.js" type="text/javascript"></script>
	<script src="./MIDI/js/midi/gm.js" type="text/javascript"></script>
	<script src="./MIDI/js/midi/loader.js" type="text/javascript"></script>
	<script src="./MIDI/js/midi/plugin.audiotag.js" type="text/javascript"></script>
	<script src="./MIDI/js/midi/plugin.webaudio.js" type="text/javascript"></script>
	<script src="./MIDI/js/midi/plugin.webmidi.js" type="text/javascript"></script>
	<!-- utils -->
	<script src="./MIDI/js/util/dom_request_xhr.js" type="text/javascript"></script>
	<script src="./MIDI/js/util/dom_request_script.js" type="text/javascript"></script>

  <script src="./js/sound_note_system.js" type="text/javascript"></script>
  <script src="./js/sound_note_component.js" type="text/javascript"></script>
</head>
<body style='margin : 0px; overflow: hidden;'>
  <script>
    window.onload = function() {
      MIDI.loadPlugin({
        soundfontUrl: "https://gleitz.github.io/midi-js-soundfonts/FluidR3_GM/",
        instruments: [0, 21],
        onprogress: function(state, progress) {
          console.log(state, progress);
        },
        onsuccess: function() {
        }
      });
    };

  </script>

  <a-scene embedded arjs='sourceType: webcam;' sound_note>
    <a-assets>
      <a-asset-item response-type="arraybuffer" id="note" src="./models/1la_chang.stl"></a-asset-item>
    </a-assets>

    <a-marker type='pattern' url='./patterns/patt/re.patt' emitevents='true'>
      <a-entity position='0 0.5 0' material="color: red" sound_note="instrument: acoustic_grand_piano; note: re3">
          <a-animation attribute="rotation"
               easing="linear"
               dur="10000"
               fill="forwards"
               to="0 360 0"
               repeat="indefinite"></a-animation>
      </a-entity>
    </a-marker>

    <a-marker type='pattern' url='./patterns/patt/solb.patt' emitevents='true'>
      <a-entity position='0 0.5 0' material="color: red" sound_note="instrument: acoustic_grand_piano; note: solb3">
          <a-animation attribute="rotation"
               easing="linear"
               dur="10000"
               fill="forwards"
               to="0 360 0"
               repeat="indefinite"></a-animation>
      </a-entity>
    </a-marker>

    <a-marker type='pattern' url='./patterns/patt/la.patt' emitevents='true'>
      <a-entity position='0 0.5 0' material="color: red" sound_note="instrument: acoustic_grand_piano; note: la3">
          <a-animation attribute="rotation"
               easing="linear"
               dur="10000"
               fill="forwards"
               to="0 360 0"
               repeat="indefinite"></a-animation>
      </a-entity>
    </a-marker>

    <a-marker type='pattern' url='./patterns/pattern-marker-2.patt'>
      <a-box position='0 0.5 0' material='color: blue;' sound_note></a-box>
    </a-marker>

    <!-- add a simple camera -->
    <a-entity camera></a-entity>
  </a-scene>
</body>
